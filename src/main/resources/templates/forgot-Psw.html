<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<link rel="stylesheet"
	href="../../static/bootstrap-5.0.2/css/bootstrap.min.css"
	th:href="@{bootstrap-5.0.2/css/bootstrap.min.css}">
<script
	src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
	integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
	crossorigin="anonymous"></script>
<link rel="stylesheet" href="test.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jsencrypt/3.0.0/jsencrypt.min.js"></script>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
	
</head>
<body class="login-page-body">

	<div class="login-page">

		<div class="alert alert-success" th:if="${foundUser}">
			<p class="text-success text-center">
				We sent code to <span th:text="${user.email}"></span> . Check your
				email.
			</p>
		</div>
		<div class="alert alert-danger" th:if="${invalidOtp}">
				<p class="text-danger">Invalid Code!</p>
				</div>
		<div class="form">
			<div class="login">

				<div class="login-header mt-3">
					<div th:if="${!validOtp}">
						<h3>
							Forgot Password
							</h1>
					</div>
					<div th:if="${validOtp}">
						<h3 class="text-bold">
							Change Password
							</h1>
					</div>
				</div>
				<p th:if="${noUser}">User not found</p>
			</div>
			<div th:if="${!validOtp}" class="mt-3">
				<div th:if="${user}">
					<form id="forgotPswForm" class="login-form"
						th:action="@{/emailForForgotPsw}" method="post">
						<input type="text" placeholder="Email" th:value="${user.email}"
							name="email" />
						<!--<button class="mb-3" type="submit">submit email</button>-->
					</form>
				</div>
				<div th:if="!${user}">
					<form id="forgotPswForm" class="login-form"
						th:action="@{/emailForForgotPsw}" method="post">
						<input type="text" placeholder="Email" name="email" />
						<button class="mb-3" type="submit">submit email</button>
					</form>
				</div>
				
				<form id="otpForm" class="login-form" th:action="@{/checkOtp}"
					method="post">
					<input th:if="${user}" hidden name="email" type="text"
						th:value="${user.email}" /> <input type="text" placeholder="Otp"
						name="otp" />
					<button th:if="${user}" type="submit">submit otp</button>
				</form>
			</div>
			<div th:if="${validOtp}">
				<form th:action="@{/}">
					<div class="row mb-4">

						<div class="col-md-11">
							<div class="input-group">
								<input type="password" name="newPassword" id="password"
									class="form-control" placeholder="password"
									onkeyup="checkPasswordStrength()" required style="height: 38px">
								<div class="input-group-append">
									<p class="input-group-text">
										<i id="passwordToggleIcon" class="fa fa-eye-slash"
											style="line-height: 1.5" onclick="togglePasswordVisibility()"></i>
									</p>
								</div>
							</div>
							<span id="passwordStrengthLabel"></span>
						</div>
					</div>

					<div class="row mb-4">

						<div class="col-md-11">
							<div class="input-group">
								<input type="password" name="confirmPassword"
									id="confirmPassword" class="form-control"
									placeholder="password" onkeyup="checkPasswordStrength()"
									required style="height: 38px">
								<div class="input-group-append">
									<p class="input-group-text">
										<i id="confirmPasswordToggleIcon" class="fa fa-eye-slash"
											style="line-height: 1.5"
											onclick="toggleConfirmPasswordVisibility()"></i>
									</p>
								</div>
							</div>
							<span id="matchLabel"></span>
						</div>
					</div>

					<div class="col-md-3 mt-3"></div>
					<div class="row mb-4">
						<div class="col-md-2"></div>

						<div class="col-md-8">

							<button type="submit"  class="btn btn-success ">Change</button>
							
						</div>
						<div class="col-md-2"></div>
					</div>
				</form>
			</div>
		</div>
	</div>

</body>
</html>
